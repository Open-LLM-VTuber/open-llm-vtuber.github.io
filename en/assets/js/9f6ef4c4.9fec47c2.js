"use strict";(self.webpackChunkmy_website=self.webpackChunkmy_website||[]).push([[4942],{2253:(e,i,n)=>{n.r(i),n.d(i,{assets:()=>c,contentTitle:()=>s,default:()=>h,frontMatter:()=>l,metadata:()=>o,toc:()=>d});const o=JSON.parse('{"id":"user-guide/live/bilibili","title":"Bilibili Live Streaming Guide","description":"We provide an experimental live platform integration that can send comments from live rooms to the Agent in real-time for interaction. Currently, only Bilibili live streaming is supported, with basic comment reading and forwarding functionality. The AI reads and responds to received comments one by one (currently, unresponded comments are added to a queue, and when messages come too quickly, the AI may experience significant response delays due to queue congestion).","source":"@site/i18n/en/docusaurus-plugin-content-docs/current/user-guide/live/bilibili.md","sourceDirName":"user-guide/live","slug":"/user-guide/live/bilibili","permalink":"/en/docs/user-guide/live/bilibili","draft":false,"unlisted":false,"editUrl":"https://github.com/Open-LLM-VTuber/Open-LLM-VTuber-Docs/tree/main/docs/user-guide/live/bilibili.md","tags":[],"version":"current","sidebarPosition":3,"frontMatter":{"sidebar_position":3},"sidebar":"docSidebar","previous":{"title":"\u76f4\u64ad\u6307\u5357 (Beta)","permalink":"/en/docs/user-guide/live"},"next":{"title":"Updating the Project","permalink":"/en/docs/user-guide/update"}}');var t=n(4848),r=n(8453);const l={sidebar_position:3},s="Bilibili Live Streaming Guide",c={},d=[{value:"0. Module Preparation",id:"0-module-preparation",level:2},{value:"1. Modify Frontend Settings",id:"1-modify-frontend-settings",level:2},{value:"2. Configure <code>conf.yaml</code>",id:"2-configure-confyaml",level:2},{value:"2.1 Enable WebSocket Proxy and Live Prompt",id:"21-enable-websocket-proxy-and-live-prompt",level:3},{value:"2.2 Configure Bilibili Live Connection",id:"22-configure-bilibili-live-connection",level:3},{value:"2.3 Configure <code>room_ids</code>",id:"23-configure-room_ids",level:3},{value:"2.4 (Optional) Configure <code>sessdata</code>",id:"24-optional-configure-sessdata",level:3},{value:"3. Adjust AI Live Behavior (Prompt)",id:"3-adjust-ai-live-behavior-prompt",level:2},{value:"4. Start the Bilibili Live Client",id:"4-start-the-bilibili-live-client",level:2},{value:"5. Begin Live Interaction",id:"5-begin-live-interaction",level:2},{value:"6. Stop Live Streaming",id:"6-stop-live-streaming",level:2}];function a(e){const i={a:"a",admonition:"admonition",code:"code",h1:"h1",h2:"h2",h3:"h3",header:"header",li:"li",ol:"ol",p:"p",pre:"pre",strong:"strong",ul:"ul",...(0,r.R)(),...e.components};return(0,t.jsxs)(t.Fragment,{children:[(0,t.jsx)(i.header,{children:(0,t.jsx)(i.h1,{id:"bilibili-live-streaming-guide",children:"Bilibili Live Streaming Guide"})}),"\n",(0,t.jsxs)(i.admonition,{title:"Feature Description",type:"info",children:[(0,t.jsx)(i.p,{children:"We provide an experimental live platform integration that can send comments from live rooms to the Agent in real-time for interaction. Currently, only Bilibili live streaming is supported, with basic comment reading and forwarding functionality. The AI reads and responds to received comments one by one (currently, unresponded comments are added to a queue, and when messages come too quickly, the AI may experience significant response delays due to queue congestion)."}),(0,t.jsxs)(i.p,{children:["If you want to support more live platforms (such as YouTube, Twitch, etc.), please refer to the ",(0,t.jsx)(i.a,{href:"../../development-guide/backend/live-dev",children:"Development Guide"})," to develop and contribute. Additionally, the default supported Bilibili live functionality does not yet implement features like gift acknowledgment or reading multiple comments together. Developers can refer to the ",(0,t.jsx)(i.a,{href:"../../development-guide/backend/live-dev",children:"Development Guide"})," to implement more features and contribute."]})]}),"\n",(0,t.jsx)(i.h2,{id:"0-module-preparation",children:"0. Module Preparation"}),"\n",(0,t.jsxs)(i.p,{children:["To use the live streaming functionality, you first need to clone the blivedm module in your ",(0,t.jsx)(i.strong,{children:"project root directory"}),":"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"git clone https://github.com/xfgryujk/blivedm/\n"})}),"\n",(0,t.jsxs)(i.p,{children:["Considering that many people don't need the Bilibili submodule functionality, this module hasn't been added to the ",(0,t.jsx)(i.code,{children:".gitmodules"})," file used with ",(0,t.jsx)(i.code,{children:"git clone --recursive"})," initially, so you need to clone it manually."]}),"\n",(0,t.jsx)(i.h2,{id:"1-modify-frontend-settings",children:"1. Modify Frontend Settings"}),"\n",(0,t.jsx)(i.p,{children:"The live feature works by using a WebSocket proxy service to connect different components:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsx)(i.li,{children:"Bilibili live client (input): receives comments from the live room"}),"\n",(0,t.jsx)(i.li,{children:"Open-LLM-VTuber main program (processing): analyzes comment content, generates responses"}),"\n",(0,t.jsx)(i.li,{children:"Frontend interface (output): displays Live2D model and responses"}),"\n"]}),"\n",(0,t.jsx)(i.p,{children:"To enable the frontend to correctly receive comments from the live room and display responses, you need to modify the WebSocket URL setting in the frontend:"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"Open the web interface settings panel (click the settings icon in the upper left corner)"}),"\n",(0,t.jsx)(i.li,{children:'In the General tab, find the "WebSocket URL" setting'}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Change the WebSocket URL to:"})," ",(0,t.jsx)(i.code,{children:"ws://127.0.0.1:12393/proxy-ws"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["The default value is typically ",(0,t.jsx)(i.code,{children:"ws://127.0.0.1:12393/client-ws"})]}),"\n",(0,t.jsxs)(i.li,{children:["Change ",(0,t.jsx)(i.code,{children:"/client-ws"})," to ",(0,t.jsx)(i.code,{children:"/proxy-ws"})," to connect to the proxy service"]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.admonition,{type:"note",children:(0,t.jsx)(i.p,{children:"After modifying the WebSocket URL, the frontend will connect directly to the proxy service instead of connecting directly to the Open-LLM-VTuber main program. This means all interactions will be forwarded through the proxy, including comments received from the Bilibili live room."})}),"\n",(0,t.jsxs)(i.h2,{id:"2-configure-confyaml",children:["2. Configure ",(0,t.jsx)(i.code,{children:"conf.yaml"})]}),"\n",(0,t.jsxs)(i.p,{children:["To connect Open-LLM-VTuber to your Bilibili live room and enable the proxy service, you need to modify the ",(0,t.jsx)(i.code,{children:"conf.yaml"})," file in the project root directory."]}),"\n",(0,t.jsx)(i.h3,{id:"21-enable-websocket-proxy-and-live-prompt",children:"2.1 Enable WebSocket Proxy and Live Prompt"}),"\n",(0,t.jsxs)(i.p,{children:["Find and modify the following configuration items in the ",(0,t.jsx)(i.code,{children:"conf.yaml"})," file:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-yaml",children:'server_config:\n  enable_proxy: true  # Must be set to true to enable the proxy service for live functionality\n  # ... other server configurations ...\n\nchat_config:\n  # ... other chat configurations ...\n  live_prompt: "live_prompt"  # Uncomment this line to enable special prompts for live mode\n'})}),"\n",(0,t.jsx)(i.p,{children:"These settings are very important:"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:"enable_proxy: true"})," - Enables the WebSocket proxy service, which is essential for live functionality"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.code,{children:'live_prompt: "live_prompt"'})," - Specifies the special prompt file to use in live mode, helping the AI better adapt to the live environment"]}),"\n"]}),"\n",(0,t.jsx)(i.h3,{id:"22-configure-bilibili-live-connection",children:"2.2 Configure Bilibili Live Connection"}),"\n",(0,t.jsxs)(i.p,{children:["Find the ",(0,t.jsx)(i.code,{children:"live_config"})," section in ",(0,t.jsx)(i.code,{children:"conf.yaml"}),":"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-yaml",children:'# Live Streaming Integration\nlive_config:\n  bilibili_live:\n    # List of BiliBili live room IDs to monitor\n    room_ids: [9447542]  # <---- Change this to your own live room ID\n    # SESSDATA cookie value (optional, for authenticated requests)\n    sessdata: ""          # <---- (Optional) Fill in your SESSDATA\n'})}),"\n",(0,t.jsxs)(i.h3,{id:"23-configure-room_ids",children:["2.3 Configure ",(0,t.jsx)(i.code,{children:"room_ids"})]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Get Room ID:"})," Enter your Bilibili live room webpage, the number after ",(0,t.jsx)(i.code,{children:"live.bilibili.com/"})," in the URL is your real room ID."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Fill in Config:"})," Enter the room ID in the ",(0,t.jsx)(i.code,{children:"room_ids"})," list. You can add multiple room IDs, and the program will randomly select one to connect to.","\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["Example: ",(0,t.jsx)(i.code,{children:"room_ids: [1234567, 9876543]"})]}),"\n"]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.h3,{id:"24-optional-configure-sessdata",children:["2.4 (Optional) Configure ",(0,t.jsx)(i.code,{children:"sessdata"})]}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Purpose:"})," ",(0,t.jsx)(i.code,{children:"SESSDATA"})," is a cookie value used by Bilibili for user authentication. If you don't fill this in, you can still connect to the live room, but usernames in received comments will be masked, and UIDs will become 0."]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"How to Get:"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"Log in to your Bilibili account in a browser."}),"\n",(0,t.jsx)(i.li,{children:"Open any Bilibili page (such as the homepage)."}),"\n",(0,t.jsxs)(i.li,{children:["Press ",(0,t.jsx)(i.code,{children:"F12"})," to open the browser developer tools."]}),"\n",(0,t.jsx)(i.li,{children:'Switch to the "Application" or "Storage" tab.'}),"\n",(0,t.jsxs)(i.li,{children:['Find "Cookies" on the left and select ',(0,t.jsx)(i.code,{children:"https://www.bilibili.com"}),"."]}),"\n",(0,t.jsxs)(i.li,{children:["Find the entry named ",(0,t.jsx)(i.code,{children:"SESSDATA"})," in the list on the right and copy its value."]}),"\n"]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:[(0,t.jsx)(i.strong,{children:"Fill in Config:"})," Paste the copied value inside the quotes of ",(0,t.jsx)(i.code,{children:'sessdata: ""'}),"."]}),"\n"]}),"\n",(0,t.jsx)(i.admonition,{title:"Security Warning",type:"danger",children:(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.code,{children:"SESSDATA"})," contains your login information, and leaking it could lead to account theft. ",(0,t.jsxs)(i.strong,{children:["Do not share your ",(0,t.jsx)(i.code,{children:"SESSDATA"})," in any public places"]})," and make sure your ",(0,t.jsx)(i.code,{children:"conf.yaml"})," file is not accessible to untrusted people."]})}),"\n",(0,t.jsx)(i.h2,{id:"3-adjust-ai-live-behavior-prompt",children:"3. Adjust AI Live Behavior (Prompt)"}),"\n",(0,t.jsxs)(i.p,{children:["The AI's speaking style and behavior in the live environment can be adjusted by modifying the ",(0,t.jsx)(i.code,{children:"prompts/utils/live_prompt.txt"})," file. The content of this file is appended to the main Persona Prompt, guiding the AI to better play the role of a live assistant."]}),"\n",(0,t.jsx)(i.p,{children:"You can modify this Prompt as needed to make the AI's live performance better match your expectations."}),"\n",(0,t.jsx)(i.h2,{id:"4-start-the-bilibili-live-client",children:"4. Start the Bilibili Live Client"}),"\n",(0,t.jsx)(i.p,{children:"After configuration, you need to run the Bilibili live client separately to connect to the live room and forward comments to the main program."}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Start the Open-LLM-VTuber Main Program:"}),"\nRun ",(0,t.jsx)(i.code,{children:"uv run run_server.py"})," to start the main program."]}),"\n"]}),"\n",(0,t.jsxs)(i.li,{children:["\n",(0,t.jsxs)(i.p,{children:[(0,t.jsx)(i.strong,{children:"Start the Bilibili Live Client:"}),"\nOpen a new terminal or command prompt window, navigate to the project root directory, and run the following command:"]}),"\n",(0,t.jsx)(i.pre,{children:(0,t.jsx)(i.code,{className:"language-bash",children:"uv run python scripts/run_bilibili_live.py\n"})}),"\n"]}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"5-begin-live-interaction",children:"5. Begin Live Interaction"}),"\n",(0,t.jsxs)(i.p,{children:["Now, when your Bilibili live room receives comments, they will be captured by the ",(0,t.jsx)(i.code,{children:"run_bilibili_live.py"})," script and forwarded to the Open-LLM-VTuber main program through the local WebSocket proxy. The AI will process these comments just like processing normal text input."]}),"\n",(0,t.jsx)(i.p,{children:"The entire workflow is as follows:"}),"\n",(0,t.jsxs)(i.ol,{children:["\n",(0,t.jsx)(i.li,{children:"A viewer sends a comment in the Bilibili live room"}),"\n",(0,t.jsxs)(i.li,{children:["The ",(0,t.jsx)(i.code,{children:"run_bilibili_live.py"})," script receives the comment"]}),"\n",(0,t.jsxs)(i.li,{children:["The comment is sent to the main program via the WebSocket proxy (",(0,t.jsx)(i.code,{children:"/proxy-ws"}),")"]}),"\n",(0,t.jsx)(i.li,{children:"The main program uses AI to process the comment content"}),"\n",(0,t.jsx)(i.li,{children:"The AI's response is sent back to the frontend through the proxy"}),"\n",(0,t.jsx)(i.li,{children:"The frontend displays the Live2D model's response"}),"\n"]}),"\n",(0,t.jsx)(i.h2,{id:"6-stop-live-streaming",children:"6. Stop Live Streaming"}),"\n",(0,t.jsxs)(i.ul,{children:["\n",(0,t.jsxs)(i.li,{children:["To stop live interaction, simply press ",(0,t.jsx)(i.code,{children:"Ctrl + C"})," in the terminal running ",(0,t.jsx)(i.code,{children:"run_bilibili_live.py"}),"."]}),"\n",(0,t.jsx)(i.li,{children:"Closing the Open-LLM-VTuber main program will also disconnect the connection."}),"\n"]})]})}function h(e={}){const{wrapper:i}={...(0,r.R)(),...e.components};return i?(0,t.jsx)(i,{...e,children:(0,t.jsx)(a,{...e})}):a(e)}},8453:(e,i,n)=>{n.d(i,{R:()=>l,x:()=>s});var o=n(6540);const t={},r=o.createContext(t);function l(e){const i=o.useContext(r);return o.useMemo((function(){return"function"==typeof e?e(i):{...i,...e}}),[i,e])}function s(e){let i;return i=e.disableParentContext?"function"==typeof e.components?e.components(t):e.components||t:l(e.components),o.createElement(r.Provider,{value:i},e.children)}}}]);